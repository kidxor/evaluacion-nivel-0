<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Aplicación de Evaluación</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Encabezado moderno */
    header {
      background: linear-gradient(90deg, #2563eb 0%, #38bdf8 100%);
      color: #fff;
      padding: 2rem 0 1.5rem 0;
      text-align: center;
      border-radius: 0 0 2rem 2rem;
      box-shadow: 0 4px 24px rgba(59,130,246,0.10);
      margin-bottom: 2rem;
    }
    header h1 {
      font-family: 'Montserrat', Arial, sans-serif;
      font-size: 2.2rem;
      font-weight: 700;
      letter-spacing: 1px;
      margin: 0;
    }
    header p {
      font-size: 1.15rem;
      font-weight: 400;
      margin-top: 0.7rem;
      color: #e0e7ff;
    }
    /* Modal estilos */
    .modal-bg {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(37,99,235,0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .modal-box {
      background: #fff;
      border-radius: 1.2rem;
      box-shadow: 0 4px 24px rgba(59,130,246,0.15);
      padding: 2rem 2.5rem;
      max-width: 350px;
      width: 100%;
      text-align: center;
      animation: fadeIn 0.3s;
    }
    .modal-box h2 {
      color: #2563eb;
      margin-bottom: 1.2rem;
      font-size: 1.3rem;
      font-weight: 700;
    }
    .modal-box label {
      display: block;
      margin-bottom: 1rem;
      text-align: left;
      font-weight: 500;
      color: #374151;
    }
    .modal-box input[type="text"] {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #dbeafe;
      border-radius: 0.5rem;
      font-size: 1rem;
      margin-top: 0.3rem;
      margin-bottom: 1rem;
    }
    .modal-box button {
      background: #2563eb;
      color: #fff;
      border: none;
      padding: 0.7rem 2rem;
      border-radius: 0.5rem;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      margin-top: 1rem;
      transition: background 0.2s;
    }
    .modal-box button:hover {
      background: #1d4ed8;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95);}
      to { opacity: 1; transform: scale(1);}
    }
    @media (max-width: 600px) {
      header h1 { font-size: 1.3rem; }
      header p { font-size: 1rem; }
      header { padding: 1.2rem 0 1rem 0; }
      .modal-box { padding: 1.2rem 1rem; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Evaluación de Conocimientos</h1>
    <p>Completa el formulario y obtén tu resultado al instante.<br>
    <span style="font-size:0.95em;">¡Revisa tus respuestas y consulta la lista de evaluados!</span></p>
  </header>
  
  <!-- Modal para nombre y apellido -->
  <div id="userModal" class="modal-bg">
    <form id="userForm" class="modal-box" autocomplete="off">
      <h2>Ingresa tus datos</h2>
      <label>
        Nombre:
        <input type="text" id="modalFirstName" required autocomplete="given-name">
      </label>
      <label>
        Apellido:
        <input type="text" id="modalLastName" required autocomplete="family-name">
      </label>
      <button type="submit">Comenzar evaluación</button>
    </form>
  </div>

  <main style="display:none;" id="mainContent">
    <form id="quizForm">
      <!-- Los campos de nombre y apellido se llenan automáticamente -->
      <input type="hidden" id="firstName">
      <input type="hidden" id="lastName">
      <!-- Aquí se agregarán dinámicamente las preguntas -->
      <div id="questionsContainer"></div>
      <button type="submit">Enviar</button>
    </form>

    <div id="resultModal" class="modal" style="display:none;">
      <div class="modal-content">
        <span id="modalText"></span>
        <button class="close-btn" onclick="closeModal()">Cerrar</button>
      </div>
    </div>

    <div id="evaluadosList"></div>
    <a href="evaluados.html" style="display:block;margin:2rem auto;text-align:center;font-weight:bold;color:#2563eb;">Ver lista de evaluados</a>
  </main>

  <script>
    // Preguntas de ejemplo (puedes agregar más)
    const preguntas = [
      {
        id: "q1",
        texto: "¿Qué necesito para poder comenzar a trabajar como conductor en Autonomy?",
        tipo: "checkbox",
        opciones: [
          { value: "a", label: "Tener ganas de aprender" },
          { value: "b", label: "Licencia de conducir vigente" },
          { value: "c", label: "Auto propio" },
          { value: "d", label: "Certificado de antecedentes penales" },
          { value: "e", label: "Comprobante de domicilio" },
          { value: "f", label: "Pasaporte vigente" }
        ]
      },
      {
        id: "q2",
        texto: "¿Por qué es importante asistir y aprobar esta capacitación?",
        tipo: "radio",
        opciones: [
          { value: "a", label: "Para recibir un diploma" },
          { value: "b", label: "Para acceder a un vehículo Autonomy y poder comenzar a generar ingresos" },
          { value: "c", label: "Porque es obligatorio para cualquier trabajo" },
          { value: "d", label: "Para conocer a otros conductores" }
        ]
      }
      // Puedes agregar más preguntas aquí...
    ];

    // Respuestas correctas
    const correctas = {
      q1: ['a', 'b', 'd', 'e'],
      q2: 'b'
      // Agrega más respuestas correctas aquí...
    };

    // Renderizar preguntas
    function renderPreguntas() {
      const container = document.getElementById('questionsContainer');
      container.innerHTML = preguntas.map(p => {
        if (p.tipo === "checkbox") {
          return `
            <div class="question">
              <p><b>${p.texto}</b></p>
              ${p.opciones.map(o =>
                `<label><input type="checkbox" name="${p.id}" value="${o.value}"> ${o.label}</label>`
              ).join('')}
            </div>
          `;
        } else if (p.tipo === "radio") {
          return `
            <div class="question">
              <p><b>${p.texto}</b></p>
              ${p.opciones.map(o =>
                `<label><input type="radio" name="${p.id}" value="${o.value}" required> ${o.label}</label>`
              ).join('')}
            </div>
          `;
        }
        return '';
      }).join('');
    }

    // Modal para datos de usuario
    document.getElementById('userForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const nombre = document.getElementById('modalFirstName').value.trim();
      const apellido = document.getElementById('modalLastName').value.trim();
      if (!nombre || !apellido) return;
      document.getElementById('firstName').value = nombre;
      document.getElementById('lastName').value = apellido;
      document.getElementById('userModal').style.display = 'none';
      document.getElementById('mainContent').style.display = 'block';
      renderPreguntas();
    });

    // Evaluar respuestas y mostrar resultado
    document.getElementById('quizForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const nombre = document.getElementById('firstName').value;
      const apellido = document.getElementById('lastName').value;
      // Obtener respuestas
      const respuestas = {};
      preguntas.forEach(p => {
        if (p.tipo === "checkbox") {
          respuestas[p.id] = Array.from(document.querySelectorAll(`input[name="${p.id}"]:checked`)).map(i => i.value);
        } else if (p.tipo === "radio") {
          const val = document.querySelector(`input[name="${p.id}"]:checked`);
          respuestas[p.id] = val ? val.value : '';
        }
      });
      // Calcular puntaje
      let score = 0;
      let total = preguntas.length;
      if (Array.isArray(respuestas.q1) && Array.isArray(correctas.q1) &&
          respuestas.q1.sort().join(',') === correctas.q1.sort().join(',')) score++;
      if (respuestas.q2 === correctas.q2) score++;
      // Agrega más lógica si tienes más preguntas
      const percent = Math.round((score / total) * 100);
      const passed = percent >= 70;
      // Guardar en localStorage
      const evaluados = JSON.parse(localStorage.getItem('evaluados') || '[]');
      evaluados.push({
        nombre,
        apellido,
        fecha: new Date().toLocaleString(),
        score,
        total,
        percent,
        passed,
        respuestas
      });
      localStorage.setItem('evaluados', JSON.stringify(evaluados));
      // Mostrar resultado inmediato
      const modal = document.getElementById('resultModal');
      document.getElementById('modalText').innerHTML =
        `<b>${nombre} ${apellido}</b>, obtuviste <b>${score}</b> de <b>${total}</b> (${percent}%).<br>
        <span style="color:${passed ? '#16a34a' : '#dc2626'}; font-weight:bold;">
          ${passed ? 'Aprobado ✅' : 'No aprobado ❌'}
        </span>`;
      modal.style.display = 'block';
    });

    function closeModal() {
      document.getElementById('resultModal').style.display = 'none';
    }
  </script>
</body>
</html>